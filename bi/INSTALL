Bi INSTALL file
------------------------------------------------------------------------------

Requirements
------------------------------------------------------------------------------

The following (non-standard) Perl modules are required:

  * Template,
  * Math::Symbolic,
  * Carp::Assert,
  * Parse::Yapp,
  * Parse::Lex,
  * File::Slurp,
  * File::ShareDir,
  * Getopt::ArgvFile.

These can be installed using the "cpan" program available on most systems.
Simply type "install Template Math::Symbolic etc".

The following packages are required:

  * a C++ compiler,
  * GNU Autotools: autoconf and automake <www.gnu.org/software/>,
  * Thrust 1.6 or later <thrust.github.com>,
  * NetCDF 4.0.1 or later <www.unidata.ucar.edu/software/netcdf/>,
  * QRUpdate <qrupdate.sourceforge.net/>,
  * GNU Scientific Library <www.gnu.org/software/gsl/>,
  * Boost 1.43 or later, specifically Boost.Random and Boost.TypeOf
    <www.boost.org/>,
  * a BLAS implementation <www.netlib.org/blas/>,
  * a LAPACK implementation <www.netlib.org/lapack/>.

Note that you should install, where applicable, both the compiled libraries
and headers of these libraries; often the headers are available via separate
*-devel packages in the package manager of your Linux distribution.

For GPU support, the following additional packages are required:

  * CUDA 4.0 or later (including CUBLAS and CURAND) <www.nvidia.com/cuda>,
  * MAGMA 0.2 or later <icl.cs.utk.edu/magma/>.

For MPI support, the following additional packages are required:

  * An MPI implementation,
  * Boost.MPI and Boost.Serialization <www.boost.org/>.

The following packages are optional for building documentation and visualising
models:

  * Doxygen <www.doxygen.org>,
  * dot,
  * graphviz,
  * pod2latex,
  * latex2html,
  * pdflatex.


Installation on Mac
------------------------------------------------------------------------------

Firstly fire up Xcode and use Xcode Preferences and install "Command Line
Tools". This will give you some of the basics.

Install MacPorts from macports.org.

The following seems necessary on Mountain Lion or some MacPorts packages don't
install:

sudo xcodebuild -license

Apparently it might be Mountain Lion specific, but probably won't hurt on
Lion.

Now install required packages from MacPorts:

sudo port install autoconf automake netcdf netcdf-cxx qrupdate atlas boost gsl

This can take over an hour!

To ensure that Bi can find the gfortran libraries, symlink them into the
/opt/local/lib directory as follows:

sudo ln -s /opt/local/lib/gcc45/libgfortran.a /opt/local/lib/.
sudo ln -s /opt/local/lib/gcc45/libgfortran.dylib /opt/local/lib/.

Download Thrust from thrust.github.com, unzip and move the thrust/ directory
to /opt/local/include/:

sudo mv thrust /opt/local/include/.

Now install the required Perl modules:

sudo cpan
install Template Math::Symbolic Carp::Assert Parse::Yapp Parse::Lex \
    Parse::Slurp File::ShareDir Getopt::ArgvFile

It is important that you do this *after* installing the MacPorts dependencies
above, otherwise the modules will be installed to the system default perl, not
MacPorts' perl.

Now, set up the environment for Bi to compile its client programs. Firstly,
add the following to ~/.profile

export LDFLAGS='-L/opt/local/lib'
export CPPFLAGS='-I/opt/local/include'
export LD_LIBRARY_PATH=/opt/local/lib
export LD_INCLUDE_PATH=/opt/local/include

Bi needs to use the MacPorts g++ compiler in /opt/local/bin, not the system
default g++ in /usr/bin. To do this, set the following environment variable:

export CXX=/opt/local/bin/g++-mp-*

You can put this in ~/.profile, although keep in mind that *any* configure
scripts that you run will then use this g++, not just Bi. This mightn't be a
problem. If it is, just enter the above line each time you open a terminal
window.

Quit Terminal then start it again, to ensure that these environment variables
are set.

Bi can then be run with:

/path/to/bi/script/bi ...

You can add /path/to/bi/script to your PATH variable in ~/.profile also, in
which case in future you can just use the following from any directory:

bi sample @sample.conf
